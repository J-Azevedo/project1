/* Includes ------------------------------------------------------------------*/
#include "gyroscopeDriver.h"
#include "gyroAcquisitionTask.h"
#include <FreeRTOS.h>
#include <task.h>
#include <queue.h>
#include <semphr.h>
#include "main.h"

extern xQueueHandle xQGyroData;
//float data_in4[] = { 0.437500, -0.402500, 0.140000, 0.857500, 1.426250, 2.222500, 3.780000, 3.421250, 4.208750, 10.263750, 19.818750, 30.406250, 34.868752, 35.218750, 28.656250, 26.188749, 20.466249, 16.406250, 17.395000, 16.336250, 19.136250, 16.887501, 19.897501, 16.721251, 11.725000, 11.427500, 7.700000, 10.342500, 14.096251, 19.241251, 22.233749, 21.647501, 16.826250, 17.281250, 13.282500, 9.581250, 16.555000, 11.873750, 12.416250, 11.427500, 12.442500, 11.585000, 12.722500, 13.300000, 11.270000, 6.370000, 1.426250, 0.717500, -2.555000, -2.336250, -7.201250, -13.903750, -21.376249, -32.873749, -31.526251, -39.987499, -38.027500, -32.532501, -30.441250, -17.368750, -17.167500, -19.705000, -20.230000, -22.120001, -32.480000, -31.184999, -28.892500, -25.129999, -24.386250, -25.331249, 0.131250, -17.998751, -15.303750, -16.782499, -17.955000, -19.188749, -18.733749, -16.738750, -12.958750, -9.231250, -9.318750, -4.847500, -0.630000, -5.005000, -8.680000, -6.965000, -6.606250, -7.761250, -3.771250, 1.715000, 0.831250, 4.060000, 2.966250, 3.578750, -0.008750, -0.008750, -0.297500, 0,0 };
//float sampleData[] =	{ 2.730000,7.087500,4.243750,6.265000,16.441250,15.610000,20.440001,28.131250,25.611250,25.287500,24.307501,26.101250,24.508751,25.121250,26.748751,20.545000,19.871250,14.481250,11.112500,13.020000,18.296249,18.252501,19.512501,17.027500,13.545000,13.790000,15.758750,15.636250,18.462500,16.178751,11.926250,11.445000,5.923750,1.960000,0.542500,-0.603750,-2.703750,0.910000,-4.690000,-8.260000,-10.587500,-10.613750,-8.933750,-11.795000,-2.458750,-6.553750,-9.371250,-15.793750,-16.301250,-20.606251,-23.677500,-28.236250,-23.563749,-18.392500,-16.695000,-17.482500,-13.842500,-17.508751,-27.002501,-26.976250,-24.535000,-27.291250,-28.577499,-23.712500,-24.150000,-21.315001,-16.738750,-17.622499,-18.663750,-20.606251,-20.921249,-21.603750,-18.943750,-16.161249,-14.752501,-13.982500,-11.970000,-8.671250,-7.175000,-0.796250,4.637500,5.311250,5.355000,10.158750,0.770000,-0.551250,-2.231250,-4.252500,-1.741250,-4.453750,-3.080000,-5.416250,-3.368750,-1.863750,-0.883750,-0.393750,1.015000,1.505000,1.207500 };
void gyroAcquisitionTask()
{
static int i=0;

static	l3gd20Data data[100];
//	l3gd20Data sdata;
	float x=0;
	//acquire the data from the gyroscope
	data[i]=gyroReadAxisValue();
	//x=data[i].x;
	i++;
	//send the data to the back of the queue, to be read in the processing task
	xQueueSendToBack(xQGyroData,&x,(TickType_t)50);
	//delay the task for a period of 50 ms 
	vTaskDelay(50 / portTICK_RATE_MS);	

	if(i==99)
		i=0;
	
//4.28


}